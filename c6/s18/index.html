
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="通过python解决算法和数据结构问题">
      
      
      
      
        <link rel="prev" href="../s17/">
      
      
        <link rel="next" href="../s19/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>6.18. AVL树实现 - python数据结构和算法 - 中文版</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#618-avl树实现" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="python数据结构和算法 - 中文版" class="md-header__button md-logo" aria-label="python数据结构和算法 - 中文版" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            python数据结构和算法 - 中文版
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6.18. AVL树实现
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/pythonds-zh-cn/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    python数据结构和算法 - 中文版
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c1/" class="md-tabs__link">
          
  
    
  
  1. 引言

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c2/" class="md-tabs__link">
          
  
    
  
  2. 算法分析

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c3/" class="md-tabs__link">
          
  
    
  
  3. 基本数据结构

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c4/" class="md-tabs__link">
          
  
    
  
  4. 递归

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c5/" class="md-tabs__link">
          
  
    
  
  5. 搜索与排序

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  6. 树和树算法

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c7/" class="md-tabs__link">
          
  
    
  
  7. 图和图算法

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c8/" class="md-tabs__link">
          
  
    
  
  8. 高级主题

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="python数据结构和算法 - 中文版" class="md-nav__button md-logo" aria-label="python数据结构和算法 - 中文版" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    python数据结构和算法 - 中文版
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/pythonds-zh-cn/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    python数据结构和算法 - 中文版
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c1/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    1. 引言
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            1. 引言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2. 入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3. 什么是计算机科学？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4. 什么是编程？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5. 为什么学习数据结构和抽象数据类型？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.6. 为什么学习算法？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7. Python基础回顾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8. 数据入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.9. 输入和输出
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.10. 控制结构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.11. 异常处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.12. 定义函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.13. Python中的面向对象编程：定义类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.14. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.15. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.16. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c2/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    2. 算法分析
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            2. 算法分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2. 什么是算法分析？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3. 大O表示法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4. 一个字谜检测例子
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5. Python数据结构的性能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6. 列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7. 字典
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.8. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.9. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.10. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c3/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    3. 基本数据结构
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            3. 基本数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2. 什么是线性结构？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3. 栈
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4. 栈的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5. 用Python实现栈
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.6. 简单的括号匹配
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.7. 符号匹配（一般情况）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.8. 将十进制数转换为二进制数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.9. 中缀、前缀和后缀表达式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.10. 队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.11. 队列的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.12. 用Python实现队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.13. 队列模拟：烫手山芋游戏
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.14. 队列模拟：打印任务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.15. 双端队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.16. 双端队列的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.17. 用Python实现双端队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.18. 回文检测器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.19. 列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.20. 无序列表的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.21. 用链表实现无序列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.22. 有序列表的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.23. 实现有序列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.24. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s25/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.25. 关键词术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s26/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.26. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c4/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    4. 递归
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            4. 递归
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2. 什么是递归？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3. 计算一个数列的和
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4. 递归的三条法则
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.5. 将整数转换为任意进制的字符串
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.6. 栈帧：实现递归
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.7. 递归的可视化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.8. 谢尔宾斯基三角形
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.9. 复杂的递归问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.10. 汉诺塔问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.11. 迷宫探索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.12. 动态规划
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.13. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.14. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.15. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c5/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    5. 搜索与排序
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            5. 搜索与排序
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2. 搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3. 顺序搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4. 二分搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5. 哈希
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6. 排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.7. 冒泡排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.8. 选择排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.9. 插入排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.10. 希尔排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.11. 归并排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.12. 快速排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.13. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.14. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.15. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    6. 树和树算法
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            6. 树和树算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2. 树的示例
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.3. 词汇和定义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.4. 实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.5. 列表表示法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.6. 节点与引用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.7. 解析树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.8. 树遍历
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.9. 使用二叉堆的优先队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.10. 二叉堆操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.11. 二叉堆实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.12. 二叉搜索树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.13. 搜索树操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.14. 搜索树实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.15. 搜索树分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.16. 平衡二叉搜索树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.17. AVL树性能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    6.18. AVL树实现
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.19. Map ADT实现总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.20. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.21. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.22. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c7/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    7. 图和图算法
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            7. 图和图算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2. 词汇和定义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3. 图的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4. 邻接矩阵
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.5. 邻接表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.6. 实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.7. 字梯问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.8. 构建字梯图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.9. 实现广度优先搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.10. 广度优先搜索分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.11. 骑士巡游问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.12. 构建骑士巡游图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.13. 实现骑士巡游
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.14. 骑士巡游分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.15. 一般的深度优先搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.16. 深度优先搜索分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.17. 拓扑排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.18. 强连通分量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.19. 最短路径问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.20. Dijkstra算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.21. Dijkstra算法分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.22. Prim生成树算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.23. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.24. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s25/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.25. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c8/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    8. 高级主题
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            8. 高级主题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.2. Python列表再探
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.3. 递归再探
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.4. 字典再探：跳表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.5. 树再探：图像量化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c8/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.6. 图再探：模式匹配
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="618-avl树实现">6.18. AVL树实现<a class="headerlink" href="#618-avl树实现" title="Permanent link">&para;</a></h1>
<p><strong>6.18. AVL Tree Implementation</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Now that we have demonstrated that keeping an AVL tree in balance is going to be a big performance improvement, let's look at how we will augment the procedure to insert a new key into the tree. Since all new keys are inserted into the tree as leaf nodes and we know that the balance factor for a new leaf is zero, there are no new requirements for the node that has just been inserted. But once the new leaf is added, we must update the balance factor of its parent. How this new leaf affects the parent’s balance factor depends on whether the leaf node is a left child or a right child. If the new node is a right child, the balance factor of the parent will be reduced by one. If the new node is a left child, then the balance factor of the parent will be increased by one. This rule can be applied recursively to the grandparent of the new node, and possibly to every ancestor, all the way up to the root of the tree. Since this is a recursive procedure, let's examine the two base cases for updating balance factors:</p>
<ul>
<li>The recursive call has reached the root of the tree.</li>
<li>The balance factor of the parent has been adjusted to zero. You should convince yourself that once a subtree has a balance factor of zero, then the balance of its ancestor nodes does not change.</li>
</ul>
<p>We will implement the AVL tree as a subclass of <code>BinarySearchTree</code>. To begin, we will override the <code>_put</code> method and write a new <code>update_balance</code> helper method. These methods are shown in <code>Listing 1</code>. You will notice that the definition for <code>_put</code> is exactly the same as in simple binary search trees except for the addition of the calls to <code>update_balance</code> on lines 9 and 17.</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing 1</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_put</span>(<span style="color: #008000">self</span>, key, value, current_node):
    <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #666666">&lt;</span> current_node<span style="color: #666666">.</span>key:
        <span style="color: #008000; font-weight: bold">if</span> current_node<span style="color: #666666">.</span>left_child:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_put(key, value, current_node<span style="color: #666666">.</span>left_child)
        <span style="color: #008000; font-weight: bold">else</span>:
            current_node<span style="color: #666666">.</span>left_child <span style="color: #666666">=</span> AVLTreeNode(
                key, value, <span style="color: #666666">0</span>, parent<span style="color: #666666">=</span>current_node
            )
            <span style="color: #008000">self</span><span style="color: #666666">.</span>update_balance(current_node<span style="color: #666666">.</span>left_child)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">if</span> current_node<span style="color: #666666">.</span>right_child:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_put(key, value, current_node<span style="color: #666666">.</span>right_child)
        <span style="color: #008000; font-weight: bold">else</span>:
            current_node<span style="color: #666666">.</span>right_child <span style="color: #666666">=</span> AVLTreeNode(
                key, value, <span style="color: #666666">0</span>, parent<span style="color: #666666">=</span>current_node
            )
            <span style="color: #008000">self</span><span style="color: #666666">.</span>update_balance(current_node<span style="color: #666666">.</span>right_child)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">update_balance</span>(<span style="color: #008000">self</span>, node):
    <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span> <span style="color: #AA22FF; font-weight: bold">or</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&lt;</span> <span style="color: #666666">-1</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>rebalance(node)
        <span style="color: #008000; font-weight: bold">return</span>
    <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>parent:
        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>is_left_child():
            node<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
        <span style="color: #008000; font-weight: bold">elif</span> node<span style="color: #666666">.</span>is_right_child():
            node<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>balance_factor <span style="color: #666666">-=</span> <span style="color: #666666">1</span>

        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>balance_factor <span style="color: #666666">!=</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>update_balance(node<span style="color: #666666">.</span>parent)
</code></pre></div>
<p>The new <code>update_balance</code> method is where most of the work is done. This implements the recursive procedure we just described. It first checks to see if the current node is out of balance enough to require rebalancing (line 20). If that is the case then the rebalancing is done and no further updating to parents is required. If the current node does not require rebalancing then the balance factor of the parent is adjusted. If the balance factor of the parent is nonzero then the algorithm continues to work its way up the tree toward the root by recursively calling <code>update_balance</code> on the parent.</p>
<p>When a rebalancing of the tree is necessary, how do we do it? Efficient rebalancing is the key to making the AVL Tree work well without sacrificing performance. In order to bring an AVL Tree back into balance, we will perform one or more <strong>rotations</strong> on the tree.</p>
<p>To understand what a rotation is, let's look at a very simple example. Consider the tree in the left half of <code>Figure 3</code>. This tree is out of balance with a balance factor of -2. To bring this tree into balance we will use a left rotation around the subtree rooted at node A.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/simpleunbalanced.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/simpleunbalanced.png" /></a>
    <figcaption markdown="span">Figure 3: Transforming an Unbalanced Tree Using a Left Rotation</figcaption>
</figure>    </p>
<p>To perform a left rotation we essentially do the following:</p>
<ol>
<li>Promote the right child (B) to be the root of the subtree.</li>
<li>Move the old root (A) to be the left child of the new root.</li>
<li>If new root (B) already has a left child, then make it the right child of the new left child (A). Note: since the new root (B) was the right child of A, the right child of A is guaranteed to be empty at this point. This allows us to add a new node as the right child without any further consideration.</li>
</ol>
<p>While this procedure is fairly easy in concept, the details of the code are a bit tricky since we need to move things around in just the right order so that all properties of a binary search tree are preserved. Furthermore, we need to make sure to update all of the parent pointers appropriately.</p>
<p>Let's look at a slightly more complicated tree to illustrate the right rotation. The left side of <code>Figure 4</code> shows a tree that is left-heavy and with a balance factor of 2 at the root.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/rightrotate1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/rightrotate1.png" /></a>
    <figcaption markdown="span">Figure 4: Transforming an Unbalanced Tree Using a Right Rotation</figcaption>
</figure> </p>
<p>To perform a right rotation we essentially do the following:</p>
<ol>
<li>Promote the left child (C) to be the root of the subtree.</li>
<li>Move the old root (E) to be the right child of the new root.</li>
<li>If the new root (C) already has a right child (D) then make it the left child of the new right child (E). Note: since the new root (C) was the left child of E, the left child of E is guaranteed to be empty at this point. This allows us to add a new node as the left child without any further consideration.</li>
</ol>
<p>Now that you have seen the rotations and have the basic idea of how a rotation works let us look at the code. <code>Listing 2</code> shows the code for the left rotation (the <code>rotate_right</code> method is symmetrical to <code>rotate_left</code> so we will leave it to you to study the code for <code>rotate_right</code>). In line 2 we create a temporary variable to keep track of the new root of the subtree. As we said before, the new root is the right child of the previous root. Now that a reference to the right child has been stored in this temporary variable, we replace the right child of the old root with the left child of the new.</p>
<p>The next step is to adjust the parent pointers of the two nodes. If <code>new_root</code> has a left child then the new parent of the left child becomes the old root. The parent of the new root is set to the parent of the old root. If the old root was the root of the entire tree then we must set the root of the tree to point to this new root. Otherwise, if the old root is a left child then we change the parent of the left child to point to the new root; otherwise we change the parent of the right child to point to the new root. (lines 10-13). Finally we set the parent of the old root to be the new root. This is a lot of complicated bookkeeping, so we encourage you to trace through this function while looking at <code>Figure 3</code>.</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing 2</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">rotate_left</span>(<span style="color: #008000">self</span>, rotation_root):
    new_root <span style="color: #666666">=</span> rotation_root<span style="color: #666666">.</span>right_child
    rotation_root<span style="color: #666666">.</span>right_child <span style="color: #666666">=</span> new_root<span style="color: #666666">.</span>left_child
    <span style="color: #008000; font-weight: bold">if</span> new_root<span style="color: #666666">.</span>left_child:
        new_root<span style="color: #666666">.</span>left_child<span style="color: #666666">.</span>parent <span style="color: #666666">=</span> rotation_root
    new_root<span style="color: #666666">.</span>parent <span style="color: #666666">=</span> rotation_root<span style="color: #666666">.</span>parent
    <span style="color: #008000; font-weight: bold">if</span> rotation_root<span style="color: #666666">.</span>is_root():
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_root <span style="color: #666666">=</span> new_root
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">if</span> rotation_root<span style="color: #666666">.</span>is_left_child():
            rotation_root<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>left_child <span style="color: #666666">=</span> new_root
        <span style="color: #008000; font-weight: bold">else</span>:
            rotation_root<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>right_child <span style="color: #666666">=</span> new_root
    new_root<span style="color: #666666">.</span>left_child <span style="color: #666666">=</span> rotation_root
    rotation_root<span style="color: #666666">.</span>parent <span style="color: #666666">=</span> new_root
    rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">=</span> (
        rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #008000">min</span>(new_root<span style="color: #666666">.</span>balance_factor, <span style="color: #666666">0</span>)
    )
    new_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">=</span> (
        new_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #008000">max</span>(rotation_root<span style="color: #666666">.</span>balance_factor, <span style="color: #666666">0</span>)
    )             
</code></pre></div>
<p>Finally, lines 16-21 require some explanation. In these lines we update the balance factors of the old and the new root. Since all the other moves involve moving entire subtrees, the balance factors of all other nodes are unaffected by the rotation. But how can we update the balance factors without completely recalculating the heights of the new subtrees? <code>Figure 5</code> and the following derivation should convince you that these lines are correct.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/bfderive.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/bfderive.png" /></a>
    <figcaption markdown="span">Figure 5: A Left Rotation</figcaption>
</figure>    </p>
<p><code>Figure 5</code> shows a left rotation. B and D are the pivotal nodes and A, C, E are their subtrees. Let <span class="arithmatex">\(h_x\)</span> denote the height of a particular subtree rooted at node <span class="arithmatex">\(x\)</span>. By definition we know the following:</p>
<p><span class="arithmatex">\(\begin{align} new\_bal(B) &amp;= h_A - h_C \\ old\_bal(B) &amp;= h_A - h_D \end{align}\)</span></p>
<p>But we know that the old height of D can also be given by <span class="arithmatex">\(1 + max(h_C, h_E)\)</span>, that is, the height of D is one more than the maximum height of its two children. Remember that <span class="arithmatex">\(h_C\)</span> and <span class="arithmatex">\(h_E\)</span> have not changed. So, let us substitute that in to the second equation, which gives us </p>
<p><span class="arithmatex">\(old\_bal(B) = h_A - (1 + max(h_C,h_E))\)</span> </p>
<p>and then subtract the two equations. The following steps do the subtraction and use some algebra to simplify the equation for <span class="arithmatex">\(new\_bal(B)\)</span>.</p>
<p><span class="arithmatex">\(\begin{align} new\_bal(B) - old\_bal(B) &amp;= h_A - h_C - (h_A - (1 + max(h_C,h_E))) \\ new\_bal(B) - old\_bal(B) &amp;= h_A - h_C - h_A + (1 + max(h_C,h_E)) \\ new\_bal(B) - old\_bal(B) &amp;= h_A  - h_A + 1 + max(h_C,h_E) - h_C  \\ new\_bal(B) - old\_bal(B) &amp;=  1 + max(h_C,h_E) - h_C \end{align}\)</span></p>
<p>Next we will move <span class="arithmatex">\(old\_bal(B)\)</span> to the right-hand side of the equation and make use of the fact that <span class="arithmatex">\(max(a,b)-c = max(a-c, b-c)\)</span>.</p>
<p><span class="arithmatex">\(new\_bal(B) = old\_bal(B) + 1 + max(h_C - h_C ,h_E - h_C)\)</span></p>
<p>But <span class="arithmatex">\(h_E - h_C\)</span> is the same as <span class="arithmatex">\(-old\_bal(D)\)</span>. So we can use another identity that says <span class="arithmatex">\(max(-a,-b) = -min(a,b)\)</span>. So we can finish our derivation of <span class="arithmatex">\(new\_bal(B)\)</span> with the following steps:</p>
<p><span class="arithmatex">\(\begin{align} new\_bal(B) &amp;= old\_bal(B) + 1 + max(0 , -old\_bal(D)) \\ new\_bal(B) &amp;= old\_bal(B) + 1 - min(0 , old\_bal(D)) \end{align}\)</span></p>
<p>Now we have all of the parts in terms that we readily know. If we remember that B is <code>rotation_root</code> and D is <code>new_root</code> then we can see this corresponds exactly to the statement on lines 16-18 in <code>Listing 2</code>, or:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">=</span> (
    rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #008000">min</span>(new_root<span style="color: #666666">.</span>balance_factor, <span style="color: #666666">0</span>)
)
</code></pre></div>
<p>A similar derivation gives us the equation for the updated node D as well as the balance factors after a right rotation. We leave these as an exercise for you.</p>
<p>Now you might think that we are done. We know how to do our left and right rotations, and we know when we should do a left or right rotation.  But take a look at <code>Figure 6</code>. Since node A has a balance factor of -2 we should do a left rotation. But what happens when we do the left rotation around A?</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/hardunbalanced.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/hardunbalanced.png" /></a>
    <figcaption markdown="span">Figure 6: An Unbalanced Tree that is More Difficult to Balance</figcaption>
</figure>    </p>
<p><code>Figure 7 &lt;fig_badrotate&gt;</code> shows us that after the left rotation we are now out of balance the other way. If we do a right rotation to correct the situation we are right back where we started.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/badrotate.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/badrotate.png" /></a>
    <figcaption markdown="span">Figure 7: After a Left Rotation the Tree is Out of Balance in the Other Direction</figcaption>
</figure>    </p>
<p>To correct this problem we must use the following set of rules:</p>
<ol>
<li>If a subtree needs a left rotation to bring it into balance, first check the balance factor of the right child. If the right child is left-heavy, then do a right rotation on right child followed by the original left rotation.</li>
<li>If a subtree needs a right rotation to bring it into balance, first check the balance factor of the left child. If the left child is right-heavy, then do a left rotation on the left child followed by the original right rotation.</li>
</ol>
<p><code>Figure 8</code> shows how these rules solve the dilemma we encountered in <code>Figure 6</code> and <code>Figure 7</code>. Starting with a right rotation around node C puts the tree in a position where the left rotation around A brings the entire subtree back into balance.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/rotatelr.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/rotatelr.png" /></a>
    <figcaption markdown="span">Figure 8: A Right Rotation Followed by a Left Rotation</figcaption>
</figure>    </p>
<p>The code that implements these rules can be found in our <code>rebalance</code> method, which is shown in <code>Listing 3</code>. Rule number 1 from above is implemented by the <code>if</code> statement starting on line 2. Rule number 2 is implemented by the <code>elif</code> statement starting on line 8.</p>
<div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Listing 3</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">rebalance</span>(<span style="color: #008000">self</span>, node):
    <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>right_child<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_right(node<span style="color: #666666">.</span>right_child)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_left(node)
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_left(node)
    <span style="color: #008000; font-weight: bold">elif</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>left_child<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_left(node<span style="color: #666666">.</span>left_child)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_right(node)
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_right(node)
</code></pre></div></td></tr></table></div>
<p>The <code>discussion questions</code> provide you the opportunity to rebalance a tree that requires a left rotation followed by a right. In addition the discussion questions provide you with the opportunity to rebalance some trees that are a little more complex than the tree in <code>Figure 8</code>.</p>
<p>By keeping the tree in balance at all times, we can ensure that the <code>get</code> method will run in order <span class="arithmatex">\(O(log_2(n))\)</span> time. But the question is at what cost to our <code>put</code> method? Let us break this down into the operations performed by <code>put</code>. Since a new node is inserted as a leaf, updating the balance factors of all the parents will require a maximum of <span class="arithmatex">\(log_2(n)\)</span> operations, one for each level of the tree. If a subtree is found to be out of balance, a maximum of two rotations are required to bring the tree back into balance. But each of the rotations works in <span class="arithmatex">\(O(1)\)</span> time, so even our <code>put</code> operation remains <span class="arithmatex">\(O(log_2(n))\)</span>.</p>
<p>At this point we have implemented a functional AVL tree, unless you need the ability to delete a node. We leave the deletion of the node and subsequent updating and rebalancing as an exercise for you.</p>
</div>
<div class="tabbed-block">
<p>Now that we have demonstrated that keeping an AVL tree in balance is going to be a big performance improvement, let's look at how we will augment the procedure to insert a new key into the tree. Since all new keys are inserted into the tree as leaf nodes and we know that the balance factor for a new leaf is zero, there are no new requirements for the node that has just been inserted. But once the new leaf is added, we must update the balance factor of its parent. How this new leaf affects the parent’s balance factor depends on whether the leaf node is a left child or a right child. If the new node is a right child, the balance factor of the parent will be reduced by one. If the new node is a left child, then the balance factor of the parent will be increased by one. This rule can be applied recursively to the grandparent of the new node, and possibly to every ancestor, all the way up to the root of the tree. Since this is a recursive procedure, let's examine the two base cases for updating balance factors:</p>
<ul>
<li>The recursive call has reached the root of the tree.</li>
<li>The balance factor of the parent has been adjusted to zero. You should convince yourself that once a subtree has a balance factor of zero, then the balance of its ancestor nodes does not change.</li>
</ul>
<p>We will implement the AVL tree as a subclass of <code>BinarySearchTree</code>. To begin, we will override the <code>_put</code> method and write a new <code>update_balance</code> helper method. These methods are shown in <code>Listing 1</code>. You will notice that the definition for <code>_put</code> is exactly the same as in simple binary search trees except for the addition of the calls to <code>update_balance</code> on lines 9 and 17.</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing 1</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">_put</span>(<span style="color: #008000">self</span>, key, value, current_node):
    <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #666666">&lt;</span> current_node<span style="color: #666666">.</span>key:
        <span style="color: #008000; font-weight: bold">if</span> current_node<span style="color: #666666">.</span>left_child:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_put(key, value, current_node<span style="color: #666666">.</span>left_child)
        <span style="color: #008000; font-weight: bold">else</span>:
            current_node<span style="color: #666666">.</span>left_child <span style="color: #666666">=</span> AVLTreeNode(
                key, value, <span style="color: #666666">0</span>, parent<span style="color: #666666">=</span>current_node
            )
            <span style="color: #008000">self</span><span style="color: #666666">.</span>update_balance(current_node<span style="color: #666666">.</span>left_child)
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">if</span> current_node<span style="color: #666666">.</span>right_child:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_put(key, value, current_node<span style="color: #666666">.</span>right_child)
        <span style="color: #008000; font-weight: bold">else</span>:
            current_node<span style="color: #666666">.</span>right_child <span style="color: #666666">=</span> AVLTreeNode(
                key, value, <span style="color: #666666">0</span>, parent<span style="color: #666666">=</span>current_node
            )
            <span style="color: #008000">self</span><span style="color: #666666">.</span>update_balance(current_node<span style="color: #666666">.</span>right_child)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">update_balance</span>(<span style="color: #008000">self</span>, node):
    <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&gt;</span> <span style="color: #666666">1</span> <span style="color: #AA22FF; font-weight: bold">or</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&lt;</span> <span style="color: #666666">-1</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>rebalance(node)
        <span style="color: #008000; font-weight: bold">return</span>
    <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>parent:
        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>is_left_child():
            node<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
        <span style="color: #008000; font-weight: bold">elif</span> node<span style="color: #666666">.</span>is_right_child():
            node<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>balance_factor <span style="color: #666666">-=</span> <span style="color: #666666">1</span>

        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>balance_factor <span style="color: #666666">!=</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>update_balance(node<span style="color: #666666">.</span>parent)
</code></pre></div>
<p>The new <code>update_balance</code> method is where most of the work is done. This implements the recursive procedure we just described. It first checks to see if the current node is out of balance enough to require rebalancing (line 20). If that is the case then the rebalancing is done and no further updating to parents is required. If the current node does not require rebalancing then the balance factor of the parent is adjusted. If the balance factor of the parent is nonzero then the algorithm continues to work its way up the tree toward the root by recursively calling <code>update_balance</code> on the parent.</p>
<p>When a rebalancing of the tree is necessary, how do we do it? Efficient rebalancing is the key to making the AVL Tree work well without sacrificing performance. In order to bring an AVL Tree back into balance, we will perform one or more <strong>rotations</strong> on the tree.</p>
<p>To understand what a rotation is, let's look at a very simple example. Consider the tree in the left half of <code>Figure 3</code>. This tree is out of balance with a balance factor of -2. To bring this tree into balance we will use a left rotation around the subtree rooted at node A.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/simpleunbalanced.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/simpleunbalanced.png" /></a>
    <figcaption markdown="span">Figure 3: Transforming an Unbalanced Tree Using a Left Rotation</figcaption>
</figure>    </p>
<p>To perform a left rotation we essentially do the following:</p>
<ol>
<li>Promote the right child (B) to be the root of the subtree.</li>
<li>Move the old root (A) to be the left child of the new root.</li>
<li>If new root (B) already has a left child, then make it the right child of the new left child (A). Note: since the new root (B) was the right child of A, the right child of A is guaranteed to be empty at this point. This allows us to add a new node as the right child without any further consideration.</li>
</ol>
<p>While this procedure is fairly easy in concept, the details of the code are a bit tricky since we need to move things around in just the right order so that all properties of a binary search tree are preserved. Furthermore, we need to make sure to update all of the parent pointers appropriately.</p>
<p>Let's look at a slightly more complicated tree to illustrate the right rotation. The left side of <code>Figure 4</code> shows a tree that is left-heavy and with a balance factor of 2 at the root.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/rightrotate1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/rightrotate1.png" /></a>
    <figcaption markdown="span">Figure 4: Transforming an Unbalanced Tree Using a Right Rotation</figcaption>
</figure> </p>
<p>To perform a right rotation we essentially do the following:</p>
<ol>
<li>Promote the left child (C) to be the root of the subtree.</li>
<li>Move the old root (E) to be the right child of the new root.</li>
<li>If the new root (C) already has a right child (D) then make it the left child of the new right child (E). Note: since the new root (C) was the left child of E, the left child of E is guaranteed to be empty at this point. This allows us to add a new node as the left child without any further consideration.</li>
</ol>
<p>Now that you have seen the rotations and have the basic idea of how a rotation works let us look at the code. <code>Listing 2</code> shows the code for the left rotation (the <code>rotate_right</code> method is symmetrical to <code>rotate_left</code> so we will leave it to you to study the code for <code>rotate_right</code>). In line 2 we create a temporary variable to keep track of the new root of the subtree. As we said before, the new root is the right child of the previous root. Now that a reference to the right child has been stored in this temporary variable, we replace the right child of the old root with the left child of the new.</p>
<p>The next step is to adjust the parent pointers of the two nodes. If <code>new_root</code> has a left child then the new parent of the left child becomes the old root. The parent of the new root is set to the parent of the old root. If the old root was the root of the entire tree then we must set the root of the tree to point to this new root. Otherwise, if the old root is a left child then we change the parent of the left child to point to the new root; otherwise we change the parent of the right child to point to the new root. (lines 10-13). Finally we set the parent of the old root to be the new root. This is a lot of complicated bookkeeping, so we encourage you to trace through this function while looking at <code>Figure 3</code>.</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing 2</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">rotate_left</span>(<span style="color: #008000">self</span>, rotation_root):
    new_root <span style="color: #666666">=</span> rotation_root<span style="color: #666666">.</span>right_child
    rotation_root<span style="color: #666666">.</span>right_child <span style="color: #666666">=</span> new_root<span style="color: #666666">.</span>left_child
    <span style="color: #008000; font-weight: bold">if</span> new_root<span style="color: #666666">.</span>left_child:
        new_root<span style="color: #666666">.</span>left_child<span style="color: #666666">.</span>parent <span style="color: #666666">=</span> rotation_root
    new_root<span style="color: #666666">.</span>parent <span style="color: #666666">=</span> rotation_root<span style="color: #666666">.</span>parent
    <span style="color: #008000; font-weight: bold">if</span> rotation_root<span style="color: #666666">.</span>is_root():
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_root <span style="color: #666666">=</span> new_root
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">if</span> rotation_root<span style="color: #666666">.</span>is_left_child():
            rotation_root<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>left_child <span style="color: #666666">=</span> new_root
        <span style="color: #008000; font-weight: bold">else</span>:
            rotation_root<span style="color: #666666">.</span>parent<span style="color: #666666">.</span>right_child <span style="color: #666666">=</span> new_root
    new_root<span style="color: #666666">.</span>left_child <span style="color: #666666">=</span> rotation_root
    rotation_root<span style="color: #666666">.</span>parent <span style="color: #666666">=</span> new_root
    rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">=</span> (
        rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #008000">min</span>(new_root<span style="color: #666666">.</span>balance_factor, <span style="color: #666666">0</span>)
    )
    new_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">=</span> (
        new_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">+</span> <span style="color: #008000">max</span>(rotation_root<span style="color: #666666">.</span>balance_factor, <span style="color: #666666">0</span>)
    )             
</code></pre></div>
<p>Finally, lines 16-21 require some explanation. In these lines we update the balance factors of the old and the new root. Since all the other moves involve moving entire subtrees, the balance factors of all other nodes are unaffected by the rotation. But how can we update the balance factors without completely recalculating the heights of the new subtrees? <code>Figure 5</code> and the following derivation should convince you that these lines are correct.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/bfderive.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/bfderive.png" /></a>
    <figcaption markdown="span">Figure 5: A Left Rotation</figcaption>
</figure>    </p>
<p><code>Figure 5</code> shows a left rotation. B and D are the pivotal nodes and A, C, E are their subtrees. Let <span class="arithmatex">\(h_x\)</span> denote the height of a particular subtree rooted at node <span class="arithmatex">\(x\)</span>. By definition we know the following:</p>
<p><span class="arithmatex">\(\begin{align} new\_bal(B) &amp;= h_A - h_C \\ old\_bal(B) &amp;= h_A - h_D \end{align}\)</span></p>
<p>But we know that the old height of D can also be given by <span class="arithmatex">\(1 + max(h_C, h_E)\)</span>, that is, the height of D is one more than the maximum height of its two children. Remember that <span class="arithmatex">\(h_C\)</span> and <span class="arithmatex">\(h_E\)</span> have not changed. So, let us substitute that in to the second equation, which gives us </p>
<p><span class="arithmatex">\(old\_bal(B) = h_A - (1 + max(h_C,h_E))\)</span> </p>
<p>and then subtract the two equations. The following steps do the subtraction and use some algebra to simplify the equation for <span class="arithmatex">\(new\_bal(B)\)</span>.</p>
<p><span class="arithmatex">\(\begin{align} new\_bal(B) - old\_bal(B) &amp;= h_A - h_C - (h_A - (1 + max(h_C,h_E))) \\ new\_bal(B) - old\_bal(B) &amp;= h_A - h_C - h_A + (1 + max(h_C,h_E)) \\ new\_bal(B) - old\_bal(B) &amp;= h_A  - h_A + 1 + max(h_C,h_E) - h_C  \\ new\_bal(B) - old\_bal(B) &amp;=  1 + max(h_C,h_E) - h_C \end{align}\)</span></p>
<p>Next we will move <span class="arithmatex">\(old\_bal(B)\)</span> to the right-hand side of the equation and make use of the fact that <span class="arithmatex">\(max(a,b)-c = max(a-c, b-c)\)</span>.</p>
<p><span class="arithmatex">\(new\_bal(B) = old\_bal(B) + 1 + max(h_C - h_C ,h_E - h_C)\)</span></p>
<p>But <span class="arithmatex">\(h_E - h_C\)</span> is the same as <span class="arithmatex">\(-old\_bal(D)\)</span>. So we can use another identity that says <span class="arithmatex">\(max(-a,-b) = -min(a,b)\)</span>. So we can finish our derivation of <span class="arithmatex">\(new\_bal(B)\)</span> with the following steps:</p>
<p><span class="arithmatex">\(\begin{align} new\_bal(B) &amp;= old\_bal(B) + 1 + max(0 , -old\_bal(D)) \\ new\_bal(B) &amp;= old\_bal(B) + 1 - min(0 , old\_bal(D)) \end{align}\)</span></p>
<p>Now we have all of the parts in terms that we readily know. If we remember that B is <code>rotation_root</code> and D is <code>new_root</code> then we can see this corresponds exactly to the statement on lines 16-18 in <code>Listing 2</code>, or:</p>
<div class="language-python highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">=</span> (
    rotation_root<span style="color: #666666">.</span>balance_factor <span style="color: #666666">+</span> <span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #008000">min</span>(new_root<span style="color: #666666">.</span>balance_factor, <span style="color: #666666">0</span>)
)
</code></pre></div>
<p>A similar derivation gives us the equation for the updated node D as well as the balance factors after a right rotation. We leave these as an exercise for you.</p>
<p>Now you might think that we are done. We know how to do our left and right rotations, and we know when we should do a left or right rotation.  But take a look at <code>Figure 6</code>. Since node A has a balance factor of -2 we should do a left rotation. But what happens when we do the left rotation around A?</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/hardunbalanced.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/hardunbalanced.png" /></a>
    <figcaption markdown="span">Figure 6: An Unbalanced Tree that is More Difficult to Balance</figcaption>
</figure>    </p>
<p><code>Figure 7 &lt;fig_badrotate&gt;</code> shows us that after the left rotation we are now out of balance the other way. If we do a right rotation to correct the situation we are right back where we started.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/badrotate.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/badrotate.png" /></a>
    <figcaption markdown="span">Figure 7: After a Left Rotation the Tree is Out of Balance in the Other Direction</figcaption>
</figure>    </p>
<p>To correct this problem we must use the following set of rules:</p>
<ol>
<li>If a subtree needs a left rotation to bring it into balance, first check the balance factor of the right child. If the right child is left-heavy, then do a right rotation on right child followed by the original left rotation.</li>
<li>If a subtree needs a right rotation to bring it into balance, first check the balance factor of the left child. If the left child is right-heavy, then do a left rotation on the left child followed by the original right rotation.</li>
</ol>
<p><code>Figure 8</code> shows how these rules solve the dilemma we encountered in <code>Figure 6</code> and <code>Figure 7</code>. Starting with a right rotation around node C puts the tree in a position where the left rotation around A brings the entire subtree back into balance.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/rotatelr.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/rotatelr.png" /></a>
    <figcaption markdown="span">Figure 8: A Right Rotation Followed by a Left Rotation</figcaption>
</figure>    </p>
<p>The code that implements these rules can be found in our <code>rebalance</code> method, which is shown in <code>Listing 3</code>. Rule number 1 from above is implemented by the <code>if</code> statement starting on line 2. Rule number 2 is implemented by the <code>elif</code> statement starting on line 8.</p>
<div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Listing 3</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">rebalance</span>(<span style="color: #008000">self</span>, node):
    <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>right_child<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_right(node<span style="color: #666666">.</span>right_child)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_left(node)
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_left(node)
    <span style="color: #008000; font-weight: bold">elif</span> node<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">if</span> node<span style="color: #666666">.</span>left_child<span style="color: #666666">.</span>balance_factor <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_left(node<span style="color: #666666">.</span>left_child)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_right(node)
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000">self</span><span style="color: #666666">.</span>rotate_right(node)
</code></pre></div></td></tr></table></div>
<p>The <code>discussion questions</code> provide you the opportunity to rebalance a tree that requires a left rotation followed by a right. In addition the discussion questions provide you with the opportunity to rebalance some trees that are a little more complex than the tree in <code>Figure 8</code>.</p>
<p>By keeping the tree in balance at all times, we can ensure that the <code>get</code> method will run in order <span class="arithmatex">\(O(log_2(n))\)</span> time. But the question is at what cost to our <code>put</code> method? Let us break this down into the operations performed by <code>put</code>. Since a new node is inserted as a leaf, updating the balance factors of all the parents will require a maximum of <span class="arithmatex">\(log_2(n)\)</span> operations, one for each level of the tree. If a subtree is found to be out of balance, a maximum of two rotations are required to bring the tree back into balance. But each of the rotations works in <span class="arithmatex">\(O(1)\)</span> time, so even our <code>put</code> operation remains <span class="arithmatex">\(O(log_2(n))\)</span>.</p>
<p>At this point we have implemented a functional AVL tree, unless you need the ability to delete a node. We leave the deletion of the node and subsequent updating and rebalancing as an exercise for you.</p>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月11日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月9日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>