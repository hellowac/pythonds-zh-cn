
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="通过python解决算法和数据结构问题">
      
      
      
      
        <link rel="prev" href="../s3/">
      
      
        <link rel="next" href="../s5/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>8.4. 字典再探：跳表 - python数据结构和算法 - 中文版</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#84-字典再探跳表" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="python数据结构和算法 - 中文版" class="md-header__button md-logo" aria-label="python数据结构和算法 - 中文版" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            python数据结构和算法 - 中文版
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              8.4. 字典再探：跳表
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hellowac/pythonds-zh-cn/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    python数据结构和算法 - 中文版
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c1/" class="md-tabs__link">
          
  
    
  
  1. 引言

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c2/" class="md-tabs__link">
          
  
    
  
  2. 算法分析

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c3/" class="md-tabs__link">
          
  
    
  
  3. 基本数据结构

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c4/" class="md-tabs__link">
          
  
    
  
  4. 递归

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c5/" class="md-tabs__link">
          
  
    
  
  5. 搜索与排序

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c6/" class="md-tabs__link">
          
  
    
  
  6. 树和树算法

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../c7/" class="md-tabs__link">
          
  
    
  
  7. 图和图算法

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  8. 高级主题

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="python数据结构和算法 - 中文版" class="md-nav__button md-logo" aria-label="python数据结构和算法 - 中文版" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    python数据结构和算法 - 中文版
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hellowac/pythonds-zh-cn/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    python数据结构和算法 - 中文版
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c1/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    1. 引言
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            1. 引言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.2. 入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.3. 什么是计算机科学？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.4. 什么是编程？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.5. 为什么学习数据结构和抽象数据类型？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.6. 为什么学习算法？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.7. Python基础回顾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.8. 数据入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.9. 输入和输出
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.10. 控制结构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.11. 异常处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.12. 定义函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.13. Python中的面向对象编程：定义类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.14. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.15. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c1/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.16. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c2/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    2. 算法分析
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            2. 算法分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.2. 什么是算法分析？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.3. 大O表示法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.4. 一个字谜检测例子
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.5. Python数据结构的性能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.6. 列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.7. 字典
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.8. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.9. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c2/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.10. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c3/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    3. 基本数据结构
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            3. 基本数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2. 什么是线性结构？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.3. 栈
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.4. 栈的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.5. 用Python实现栈
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.6. 简单的括号匹配
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.7. 符号匹配（一般情况）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.8. 将十进制数转换为二进制数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.9. 中缀、前缀和后缀表达式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.10. 队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.11. 队列的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.12. 用Python实现队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.13. 队列模拟：烫手山芋游戏
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.14. 队列模拟：打印任务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.15. 双端队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.16. 双端队列的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.17. 用Python实现双端队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.18. 回文检测器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.19. 列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.20. 无序列表的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.21. 用链表实现无序列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.22. 有序列表的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.23. 实现有序列表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.24. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s25/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.25. 关键词术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c3/s26/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.26. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c4/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    4. 递归
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            4. 递归
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.2. 什么是递归？
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.3. 计算一个数列的和
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.4. 递归的三条法则
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.5. 将整数转换为任意进制的字符串
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.6. 栈帧：实现递归
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.7. 递归的可视化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.8. 谢尔宾斯基三角形
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.9. 复杂的递归问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.10. 汉诺塔问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.11. 迷宫探索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.12. 动态规划
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.13. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.14. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c4/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.15. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c5/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    5. 搜索与排序
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            5. 搜索与排序
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.2. 搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.3. 顺序搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.4. 二分搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.5. 哈希
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.6. 排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.7. 冒泡排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.8. 选择排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.9. 插入排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.10. 希尔排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.11. 归并排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.12. 快速排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.13. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.14. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c5/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5.15. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c6/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    6. 树和树算法
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            6. 树和树算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.2. 树的示例
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.3. 词汇和定义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.4. 实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.5. 列表表示法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.6. 节点与引用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.7. 解析树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.8. 树遍历
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.9. 使用二叉堆的优先队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.10. 二叉堆操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.11. 二叉堆实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.12. 二叉搜索树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.13. 搜索树操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.14. 搜索树实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.15. 搜索树分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.16. 平衡二叉搜索树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.17. AVL树性能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.18. AVL树实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.19. Map ADT实现总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.20. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.21. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c6/s22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6.22. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../c7/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    7. 图和图算法
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            7. 图和图算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.2. 词汇和定义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.3. 图的抽象数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4. 邻接矩阵
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.5. 邻接表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.6. 实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.7. 字梯问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.8. 构建字梯图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.9. 实现广度优先搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.10. 广度优先搜索分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.11. 骑士巡游问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.12. 构建骑士巡游图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.13. 实现骑士巡游
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.14. 骑士巡游分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.15. 一般的深度优先搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.16. 深度优先搜索分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.17. 拓扑排序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.18. 强连通分量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.19. 最短路径问题
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.20. Dijkstra算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.21. Dijkstra算法分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.22. Prim生成树算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.23. 总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.24. 关键术语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../c7/s25/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.25. 练习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    8. 高级主题
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            8. 高级主题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.1. 目标
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.2. Python列表再探
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.3. 递归再探
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    8.4. 字典再探：跳表
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    8.4. 字典再探：跳表
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#841-map抽象数据类型" class="md-nav__link">
    8.4.1. Map抽象数据类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#842-用python实现字典" class="md-nav__link">
    8.4.2. 用Python实现字典
  </a>
  
    <nav class="md-nav" aria-label="8.4.2. 用Python实现字典">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8421-搜索一个跳表" class="md-nav__link">
    8.4.2.1. 搜索一个跳表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8422-添加建值对到一个跳表" class="md-nav__link">
    8.4.2.2. 添加建值对到一个跳表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8423-创建一个映射" class="md-nav__link">
    8.4.2.3. 创建一个映射
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8424-分析1个跳表" class="md-nav__link">
    8.4.2.4. 分析1个跳表
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.5. 树再探：图像量化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../s6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8.6. 图再探：模式匹配
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#841-map抽象数据类型" class="md-nav__link">
    8.4.1. Map抽象数据类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#842-用python实现字典" class="md-nav__link">
    8.4.2. 用Python实现字典
  </a>
  
    <nav class="md-nav" aria-label="8.4.2. 用Python实现字典">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8421-搜索一个跳表" class="md-nav__link">
    8.4.2.1. 搜索一个跳表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8422-添加建值对到一个跳表" class="md-nav__link">
    8.4.2.2. 添加建值对到一个跳表
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8423-创建一个映射" class="md-nav__link">
    8.4.2.3. 创建一个映射
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8424-分析1个跳表" class="md-nav__link">
    8.4.2.4. 分析1个跳表
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="84-字典再探跳表">8.4. 字典再探：跳表<a class="headerlink" href="#84-字典再探跳表" title="Permanent link">&para;</a></h1>
<p><strong>8.4. Dictionaries Revisited: Skip Lists</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Python 中最通用的集合之一是 <strong>字典</strong>。字典，通常被称为 <strong>映射</strong>，存储一组键值对。键必须是唯一的，并与特定的数据值关联。给定一个键，可以从映射中查找与该键关联的数据值。将键值对放入映射中以及根据给定的键查找数据值是所有映射必须提供的基本操作。</p>
<p>例如，<code>图 1</code> 展示了一个包含键值对的映射。在这个例子中，键是整数，值是小的两字符单词。从逻辑上讲，键值对之间没有固有的顺序或组织。然而，如示例所示，如果给出一个键（93），则会返回与之关联的值（be）。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/mappic.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="图片标题" src="../imgs/mappic.png" /></a>
    <figcaption markdown="span">图 1：示例映射</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p>One of the most versatile collections available in Python is the <strong>dictionary</strong>. Dictionaries, often referred to as <strong>maps</strong>, store a collection of key-value pairs. The key, which must be unique, is assigned an association with a particular data value. Given a key, it is possible to ask the map for the corresponding associated data value. The abilities to put a key-value pair into the map and then look up a data value associated with a given key are the fundamental operations that all maps must provide.</p>
<p>For example, <code>Figure 1</code> shows a map containing key-value pairs. In this case, the keys are integers and the values are small, two-character words. From a logical perspective, there is no inherent order or organization within the pairs themselves. However, as the example shows, if a key (93) is provided to the map, the associated value (be) is returned.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/mappic.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/mappic.png" /></a>
    <figcaption markdown="span">Figure 1: An Example Map</figcaption>
</figure>   </p>
</div>
</div>
</div>
<h2 id="841-map抽象数据类型">8.4.1. Map抽象数据类型<a class="headerlink" href="#841-map抽象数据类型" title="Permanent link">&para;</a></h2>
<p><strong>8.4.1. The Map Abstract Data Type</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>映射抽象数据类型的定义如下：映射的结构，如上所述，是一组键值对，其中值可以通过其关联的键进行访问。映射的操作如下：</p>
<ul>
<li><code>Map()</code> 创建一个新的空映射。它不需要参数，并返回一个空映射。</li>
<li><code>put(key, value)</code> 向映射中添加一个新的键值对。它需要键和关联的值，并且不返回任何内容。假设该键在映射中尚不存在。</li>
<li><code>get(key)</code> 在映射中查找指定的键，并返回关联的值。它需要键，并返回一个值。</li>
</ul>
<p>需要注意的是，还有许多其他可能的操作可以添加到映射抽象数据类型中。我们将在练习中探讨这些操作。</p>
</div>
<div class="tabbed-block">
<p>The map abstract data type is defined by the following structure and operations. The structure of a map, as described above, is a collection of key-value pairs where values can be accessed via their associated key. The map operations are given below:</p>
<ul>
<li><code>Map()</code> creates a new map that is empty. It needs no parameters and returns an empty map.</li>
<li><code>put(key,value)</code> adds a new key-value pair to the map. It needs the key and the associated value and returns nothing. Assume the key is not already in the map.</li>
<li><code>get(key)</code> searches for the key in the map and returns the associated value. It needs the key and returns a value.</li>
</ul>
<p>It should be noted that there are a number of other possible operations that we could add to the map abstract data type. We will explore these in the exercises.</p>
</div>
</div>
</div>
<h2 id="842-用python实现字典">8.4.2. 用Python实现字典<a class="headerlink" href="#842-用python实现字典" title="Permanent link">&para;</a></h2>
<p><strong>8.4.2. Implementing a Dictionary in Python</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>我们已经看到了一些有趣的实现映射的方式。在第<a href="../../c5/">章排序与搜索</a>中，我们考虑了哈希表作为提供映射行为的一种手段。给定一组键和一个哈希函数，我们可以将键放入一个集合中，这样我们就可以搜索和检索关联的数据值。我们的分析显示，这种技术可以潜在地实现 <span class="arithmatex">\(O(1)\)</span> 的搜索。然而，由于表大小、冲突和冲突解决策略等问题，性能会下降。</p>
<p>在第<a href="../../c6/">章树</a>中，我们考虑了二叉搜索树作为存储这种集合的一种方式。在这种情况下，键被放置在树中，从而可以在 <span class="arithmatex">\(O(\log n)\)</span> 的时间内进行搜索。然而，这仅在树是平衡的情况下成立；即左子树和右子树的大小相似。不幸的是，依赖于插入顺序，键可能会偏向右侧或左侧。在这种情况下，搜索效率再次下降。</p>
<p>我们在这里要解决的问题是提出一种实现方法，既具备高效搜索的优点，又不具备上述缺陷。一种这样的可能性是 <strong>跳表</strong>。<code>图2</code> 显示了一个可能的跳表，用于展示 <code>图1</code> 中的键值对集合（之所以说“可能”，稍后会解释）。如图所示，跳表基本上是一个二维链表，其中所有链接都向前（向右）或向下。链表的 <em>头部</em> 可以在左上角看到。请注意，这是进入跳表结构的唯一入口。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/initskiplist.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/initskiplist.png" /></a>
    <figcaption markdown="span">图2：跳表示例</figcaption>
</figure></p>
<p>在深入了解跳表处理细节之前，先解释一些术语。<code>图3</code> 显示了跳表结构的主要部分，由一系列数据节点组成，每个数据节点保存一个键和一个关联值。此外，每个数据节点都有两个引用。<code>图4</code> 显示了单个数据节点的详细视图。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/vocabskiplist1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/vocabskiplist1.png" /></a>
    <figcaption markdown="span">图3：跳表的主体由数据节点组成</figcaption>
</figure></p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/datanode.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/datanode.png" /></a>
    <figcaption markdown="span">图4：单个数据节点</figcaption>
</figure></p>
<p><code>图5</code> 显示了两个不同的垂直列。最左侧的列由一系列头节点组成。每个头节点保存两个引用，称为 <code>down</code> 和 <code>next</code>。<code>next</code> 引用指向一个数据节点的链表。<code>down</code> 引用指向下一个较低的头节点。<code>图6</code> 显示了头节点的详细视图。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/vocabskiplist2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/vocabskiplist2.png" /></a>
    <figcaption markdown="span">图5：头节点和塔</figcaption>
</figure></p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/headernode.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/headernode.png" /></a>
    <figcaption markdown="span">图6：每个头节点保存两个引用</figcaption>
</figure></p>
<p>数据节点的列称为 <strong>塔</strong>。塔通过数据节点中的 <code>down</code> 引用链接在一起。我们可以看到，每个塔对应于一个特定的键值对，并且塔的高度可能不同。我们将在稍后讨论如何确定塔的高度，以及如何将数据添加到跳表中。</p>
<p>最后，<code>图7</code> 显示了节点的水平集合。如果仔细观察，你会发现每个层级实际上是一个有序的链表，链表中的顺序由键维持。每个链表都有一个名称，通常称为 <strong>层级</strong>。层级从0开始，层级0包含所有的节点。每个键值对必须出现在层级0的链表中。然而，当我们向上移动到更高的层级时，我们会看到节点的数量减少。这是跳表的一个重要特性，并将导致高效的搜索。再次可以看到，每个层级的节点数量与塔的高度直接相关。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/vocabskiplist3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/vocabskiplist3.png" /></a>
    <figcaption markdown="span">图7：每个水平组的数据节点就是一个层级</figcaption>
</figure></p>
<p>上述两种节点类型的类可以像前一节中简单链表那样轻松构造。头节点由两个引用组成，<code>next</code> 和 <code>down</code>，它们都在构造函数中初始化为 <code>None</code>（见 <code>Listing lst_headnode</code>）。</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_headnode</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">HeaderNode</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_next

    <span style="color: #AA22FF">@next</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> value

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_down

    <span style="color: #AA22FF">@down</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> value
</code></pre></div>
<p>数据节点有四个字段：两个用于键和值，另外两个用于 <code>next</code> 和 <code>down</code> 的引用。同样，这些引用初始化为 <code>None</code> 并封装为 <code>properties</code> 以进行数据操作（见 <code>Listing lst_datanode</code>）。</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_datanode</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">DataNode</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, key, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_key <span style="color: #666666">=</span> key
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> value
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">key</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_key

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_data

    <span style="color: #AA22FF">@data</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> value

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_next

    <span style="color: #AA22FF">@next</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> value

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_down

    <span style="color: #AA22FF">@down</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> value
</code></pre></div>
<p>跳表的构造函数如 <code>Listing lst_constructor</code> 所示。当创建跳表时，没有数据，也没有头节点。跳表的头部设置为 <code>None</code>。随着键值对的添加，列表头引用到第一个头节点，头节点进一步提供对数据节点链表的访问以及对较低层级的访问。</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_constructor</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">SkipList</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We have already seen a number of interesting ways to implement the map idea. In Chapter <a href="../../c5/">sorting-and-searching</a> we considered the hash table as a means of providing map behavior. Given a set of keys and a hash function, we could place the keys in a collection that allowed us to search and retrieve the associated data value. Our analysis showed that this technique could potentially yield an <span class="arithmatex">\(O(1)\)</span> search. However, performance degraded due to issues such as table size, collisions, and collision resolution strategy.</p>
<p>In Chapter <a href="../../c6/">trees</a> we considered a binary search tree as a way to store such a collection. In this case the keys were placed in the tree such that searching could be done in <span class="arithmatex">\(O(\log n)\)</span>. However, this was only true if the tree was balanced; that is, the left and the right subtrees were all of similar size. Unfortunately, depending on the order of insertion, the keys could end up being skewed to the right or to the left. In this case the search again degrades.</p>
<p>The problem we would like to address here is to come up with an implementation that has the advantages of an efficient search without the drawbacks described above. One such possibility is called a <strong>skip list</strong>. <code>Figure 2</code> shows a possible skip list for the collection of key-value pairs shown in <code>Figure 1</code> (the reason for saying “possible” will become apparent later). As you can see, a skip list is basically a two-dimensional linked list where the links all go forward (to the right) or down. The <em>head</em> of the list can be seen in the upper left corner. Note that this is the only entry point into the skip list structure.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/initskiplist.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/initskiplist.png" /></a>
    <figcaption markdown="span">Figure 2 An Example Skip List</figcaption>
</figure>  </p>
<p>Before moving on to the details of skip-list processing it will be useful to explain some vocabulary. <code>Figure 3</code> shows that the majority of the skip list structure consists of a collection of data nodes, each of which holds a key and an associated value. In addition, there are two references from each data node. <code>Figure 4</code> shows a detailed view of a single data node.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/vocabskiplist1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/vocabskiplist1.png" /></a>
    <figcaption markdown="span">Figure 3: The Body of the Skip List Is Made Up of Data Nodes</figcaption>
</figure>   </p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/datanode.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/datanode.png" /></a>
    <figcaption markdown="span">Figure 4: A Single Data Node</figcaption>
</figure>   </p>
<p><code>Figure 5</code> shows two different vertical columns. The leftmost column consists of a linked list of header nodes. Each header node holds two references called <code>down</code> and <code>next</code>. The <code>next</code> reference refers to a linked list of data nodes. The <code>down</code> reference refers to the next lower header node. A detailed view of a header node can be seen in <code>Figure 6</code>.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/vocabskiplist2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/vocabskiplist2.png" /></a>
    <figcaption markdown="span">Figure 5: Header Nodes and Towers</figcaption>
</figure>   </p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/headernode.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/headernode.png" /></a>
    <figcaption markdown="span">Figure 6: Each Header Node Holds Two References</figcaption>
</figure></p>
<p>The columns of data nodes are known as <strong>towers</strong>. Towers are linked together by the <code>down</code> reference in the data node. We can see that each tower corresponds to a particular key-value pair, and towers can have different heights. We will explain how the height of the tower is determined later when we consider how to add data to the skip list.</p>
<p>Finally, <code>Figure 7</code> shows a horizontal collection of nodes. If you look closely, you will notice that each level is actually an ordered linked list of data nodes where the order is maintained by the key. Each linked list is given a name, commonly referred to as its <strong>level</strong>. Levels are named starting with 0 at the lowest row. Level 0 consists of the entire collection of nodes. Every key-value pair must be present in the level-0 linked list. However, as we move up to higher levels, we see that the number of nodes decreases. This is one of the important characteristics of a skip list and will lead to an efficient search. Again, it can be seen that the number of nodes at each level is directly related to the height of the towers.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/vocabskiplist3.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/vocabskiplist3.png" /></a>
    <figcaption markdown="span">Figure 7: Each Horizontal Group of Data Nodes Is a Level</figcaption>
</figure>   </p>
<p>Classes for the two types of nodes described above can easily be constructed in the same fashion as for simple linked lists in the previous section. A header node consists of two references, <code>next</code> and <code>down</code>, both of which are initialized to <code>None</code> in the constructor (see <code>Listing lst_headnode</code>).</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_headnode</span><pre style="line-height: 125%;"><span></span><code>   <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">HeaderNode</span>:
       <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
           <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
           <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

       <span style="color: #AA22FF">@property</span>
       <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>):
           <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_next

       <span style="color: #AA22FF">@next</span><span style="color: #666666">.</span>setter
       <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>, value):
           <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> value

       <span style="color: #AA22FF">@property</span>
       <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>):
           <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_down

       <span style="color: #AA22FF">@down</span><span style="color: #666666">.</span>setter
       <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>, value):
           <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> value
</code></pre></div>
<p>A data node has four fields: two for the key and value, and two additional for the references <code>next</code> and <code>down</code>. Again, the references are initialized to <code>None</code> and wrapped into <code>properties</code> for data manipulation (see <code>Listing lst_datanode</code>).</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_datanode</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">DataNode</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, key, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_key <span style="color: #666666">=</span> key
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> value
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">key</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_key

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_data

    <span style="color: #AA22FF">@data</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_data <span style="color: #666666">=</span> value

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_next

    <span style="color: #AA22FF">@next</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">next</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_next <span style="color: #666666">=</span> value

    <span style="color: #AA22FF">@property</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_down

    <span style="color: #AA22FF">@down</span><span style="color: #666666">.</span>setter
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">down</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_down <span style="color: #666666">=</span> value
</code></pre></div>
<p>The constructor for the entire skip list is shown in <code>Listing lst_constructor</code>. When a skip list is created, there are no data and therefore no header nodes. The head of the skip list is set to <code>None</code>. As key-value pairs are added to the structure, the list head refers to the first header node which in turn provides access to a linked list of data nodes as well as access to lower levels.</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_constructor</span><pre style="line-height: 125%;"><span></span><code>   <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">SkipList</span>:
       <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
           <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">None</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="8421-搜索一个跳表">8.4.2.1. 搜索一个跳表<a class="headerlink" href="#8421-搜索一个跳表" title="Permanent link">&para;</a></h3>
<p><strong>8.4.2.1. Searching a Skip List</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>跳表的搜索操作需要一个键。它将找到包含该键的数据节点，并返回存储在节点中的相应值。<code>图8</code> 显示了搜索过程在跳表中寻找键77的过程。星标标记的节点表示在搜索过程中被考虑的节点。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/searchskiplist.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/searchskiplist.png" /></a>
    <figcaption markdown="span">图8：寻找键77的过程</figcaption>
</figure></p>
<p>在搜索键77时，我们从跳表的头部开始。第一个头节点指向保存31的数据节点。由于31小于77，我们向前移动。由于在该层级（第3层）从31没有下一个数据节点，我们必须降到第2层。这时，当我们向右查看时，我们发现一个键为77的数据节点。我们的搜索成功，返回了词 <em>of</em>。重要的是要注意，我们第一次比较的数据节点31使我们跳过了17和26。同样，从31我们能够直接到达77，绕过了54。</p>
<p><code>Listing lst_skiplistsearchcode</code> 显示了 <code>search</code> 方法的 Python 实现。搜索从列表的头部开始，逐一检查节点，直到找到键或没有更多节点可以检查为止。基本思想是从最高层级的头节点开始，并向右查找。如果没有数据节点，搜索继续在下一层级进行（第 <code>[check1 line:4]</code> 行到第 <code>[down1 line:5]</code> 行）。另一方面，如果存在数据节点，我们比较键。如果匹配，我们找到了具有所需键的数据节点，并可以返回其值（第 <code>[check2 line:7]</code> 行到第 <code>[found line:8]</code> 行）。</p>
<div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Listing lst_skiplistsearchcode</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">search</span>(<span style="color: #008000">self</span>, key):
    current <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
    <span style="color: #008000; font-weight: bold">while</span> current:
        <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:          <span style="color: #3D7B7B; font-style: italic"># check1</span>
            current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down        <span style="color: #3D7B7B; font-style: italic"># down1</span>
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>key <span style="color: #666666">==</span> key:   <span style="color: #3D7B7B; font-style: italic"># check2</span>
                <span style="color: #008000; font-weight: bold">return</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>data  <span style="color: #3D7B7B; font-style: italic"># found</span>
            <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #666666">&lt;</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>key:    <span style="color: #3D7B7B; font-style: italic"># check3</span>
                current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down    <span style="color: #3D7B7B; font-style: italic"># down2</span>
            <span style="color: #008000; font-weight: bold">else</span>:
                current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>next    <span style="color: #3D7B7B; font-style: italic"># </span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p>由于每一层都是一个有序链表，键的不匹配为我们提供了非常有用的信息。如果我们正在寻找的键小于数据节点中的键（第 <code>[check3 line:9]</code> 行），我们知道在该层级上的其他数据节点不可能包含我们的键，因为右侧的所有键必须更大。在这种情况下，我们在该塔的下一层（第 <code>[down2 line:10]</code> 行）。如果不存在这样的层级（我们降到 <code>None</code>），我们发现键不在跳表中。我们跳出循环，返回 <code>None</code>。另一方面，只要当前层级上存在键值小于我们正在寻找的键的数据节点，我们就继续移动到下一个节点（第 <code>[next1 line:12]</code> 行）。</p>
<p>一旦进入较低的层级，我们重复检查是否有下一个节点的过程。跳表中的每一层都可能提供额外的数据节点。如果键存在，它将在第0层之前被发现，因为第0层是完整的有序链表。我们的希望是能尽早找到它。</p>
</div>
<div class="tabbed-block">
<p>The search operation for a skip list will require a key. It will find a data node containing that key and return the corresponding value that is stored in the node. <code>Figure 8</code> shows the search process as it proceeds through the skip list looking for the key 77. The nodes marked by stars represent those that are considered during the search process.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/searchskiplist.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/searchskiplist.png" /></a>
    <figcaption markdown="span">Figure 8: Searching for the Key 77</figcaption>
</figure>   </p>
<p>As we search for 77, we begin at the head of the skip list. The first header node refers to the data node holding 31. Since 31 is less than 77, we move forward. Now since there is no next data node from 31 at that level (level 3), we must drop down to level 2. This time, when we look to the right, we see a data node with the key 77. Our search is successful and the word <em>of</em> is returned. It is important to note that our first comparison, data node 31, allowed us to skip over 17 and 26. Likewise, from 31 we were able to go directly to 77, bypassing 54.</p>
<p><code>Listing lst_skiplistsearchcode</code> shows the Python implementation of the <code>search</code> method. The search starts at the head of the list and searches through nodes until either the key is found or there are no more nodes to check. The basic idea is to start at the header node of the highest level and begin to look to the right. If no data node is present, the search continues on the next lower level (lines <code>[check1 line:4]</code>–<code>[down1 line:5]</code>). On the other hand, if a data node exists, we compare the keys. If there is a match, we have found a data node with the key we are looking for and we can return its value (lines <code>[check2 line:7]</code>–<code>[found line:8]</code>).</p>
<div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Listing lst_skiplistsearchcode</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">search</span>(<span style="color: #008000">self</span>, key):
    current <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
    <span style="color: #008000; font-weight: bold">while</span> current:
        <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:          <span style="color: #3D7B7B; font-style: italic"># check1</span>
            current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down        <span style="color: #3D7B7B; font-style: italic"># down1</span>
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>key <span style="color: #666666">==</span> key:   <span style="color: #3D7B7B; font-style: italic"># check2</span>
                <span style="color: #008000; font-weight: bold">return</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>data  <span style="color: #3D7B7B; font-style: italic"># found</span>
            <span style="color: #008000; font-weight: bold">if</span> key <span style="color: #666666">&lt;</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>key:    <span style="color: #3D7B7B; font-style: italic"># check3</span>
                current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down    <span style="color: #3D7B7B; font-style: italic"># down2</span>
            <span style="color: #008000; font-weight: bold">else</span>:
                current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>next    <span style="color: #3D7B7B; font-style: italic"># </span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
<p>Since each level is an ordered linked list, a key mismatch provides us with very useful information. If the key we are looking for is less than the key contained in the data node (line <code>[check3 line:9]</code>), we know that no other data node on that level can contain our key since everything to the right has to be greater. In that case, we drop down one level in that tower (line <code>[down2 line:10]</code>). If no such level exists (we drop to <code>None</code>), we have discovered that the key is not present in our skip list. We break out of the loop and return <code>None</code>. On the other hand, as long as there are data nodes on the current level with key values less than the key we are looking for, we continue moving to the next node (line <code>[next1 line:12]</code>).</p>
<p>Once we enter a lower level, we repeat the process of checking to see if there is a next node. Each level lower in the skip list has the potential to provide additional data nodes. If the key is present, it will have to be discovered no later than level 0 since level 0 is the complete ordered linked list. Our hope is that we will find it sooner.</p>
</div>
</div>
</div>
<h3 id="8422-添加建值对到一个跳表">8.4.2.2. 添加建值对到一个跳表<a class="headerlink" href="#8422-添加建值对到一个跳表" title="Permanent link">&para;</a></h3>
<p><strong>8.4.2.2. Adding Key-Value Pairs to a Skip List</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>如果我们给定一个跳表，<code>search</code> 方法的实现相对简单。我们的任务是理解跳表结构最初是如何构建的，以及为什么相同的键集以相同的顺序添加可以生成不同的跳表。</p>
<p>将一个新的键值对添加到跳表中，实际上是一个两步过程。首先，我们在跳表中搜索键应该插入的位置。记住，我们假设键尚不存在。<code>图9</code> 显示了这个过程，我们要将键65（数据值“hi”）添加到集合中。我们再次使用星标来显示搜索过程的路径。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/addskiplist.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/addskiplist.png" /></a>
    <figcaption markdown="span">图9：搜索键65的位置</figcaption>
</figure></p>
<p>按照与前面章节相同的搜索策略，我们发现65大于31。由于在第3层没有更多节点，我们降到第2层。在这里，我们找到77，它大于65。我们再次降到第1层。这时，下一个节点是54，它小于65。继续向右查找，我们遇到77，这使我们再次降到最底层，直到最终遇到塔的<code>None</code>。</p>
<p>第二步是创建一个新的数据节点并将其添加到第0层的链表中（<code>图10</code>）。然而，如果我们在此时停止，我们得到的将仅是一个键值对的单链表。我们还需要为新的条目构建一个塔，这就是跳表非常有趣的地方。这个塔应该有多高呢？新条目的塔的高度不会预先确定，而是完全随机的。实际上，我们会抛硬币来决定是否为塔添加另一层。每次硬币显示正面时，我们就为当前塔添加一层。</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/addskiplist2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/addskiplist2.png" /></a>
    <figcaption markdown="span">图10：添加65的数据节点和塔</figcaption>
</figure></p>
<p>使用随机数生成器模拟抛硬币非常简单。我们可以使用 <code>random</code> 模块中的 <code>randrange</code> 并将1解释为正面。</p>
<p><code>Listing lst_insert</code> 显示了 <code>insert</code> 方法。你会立即注意到第2行中我们需要检查是否这是第一次向跳表中添加节点。这与我们在简单链表中遇到的问题相同。如果我们正在向链表的头部添加，则必须创建一个新的头节点和数据节点。第7到14行中的迭代会持续进行，只要 <code>randrange</code> 函数返回1（硬币抛出正面）。每次添加新层到塔时，我们都会创建一个新的数据节点和新的头节点。</p>
<p>在非空的跳表情况下（第15行），我们需要按上述描述搜索插入位置。由于我们不知道将会向塔中添加多少数据节点，我们需要保存每层的插入点作为搜索过程的一部分。这些插入点将按照相反的顺序处理，因此使用栈来回溯链表，并在必要时插入塔的数据节点。<code>图10</code> 中的星标显示了在示例中会被堆叠的插入点。这些点仅表示我们在搜索过程中下降的地方。</p>
<p>从第34行开始，我们抛硬币决定塔的层数。这时我们弹出插入栈以获取下一个较高的插入点，塔会逐渐增加高度。只有当栈变为空时，我们才需要返回去创建新的头节点。我们将其余的实现细节留给你去追踪。</p>
<div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Listing lst_insert</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">49</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">insert</span>(<span style="color: #008000">self</span>, key, value):
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> HeaderNode()
        temp <span style="color: #666666">=</span> DataNode(key, value)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_head<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
        top <span style="color: #666666">=</span> temp
        <span style="color: #008000; font-weight: bold">while</span> randrange(<span style="color: #666666">2</span>) <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
            newhead <span style="color: #666666">=</span> HeaderNode()
            temp <span style="color: #666666">=</span> DataNode(key, value)
            temp<span style="color: #666666">.</span>down <span style="color: #666666">=</span> top
            newhead<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
            newhead<span style="color: #666666">.</span>down <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> newhead
            top <span style="color: #666666">=</span> temp
    <span style="color: #008000; font-weight: bold">else</span>:
        tower <span style="color: #666666">=</span> Stack()
        current <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
        <span style="color: #008000; font-weight: bold">while</span> current:
            <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
                tower<span style="color: #666666">.</span>push(current)
                current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down
            <span style="color: #008000; font-weight: bold">else</span>:
                <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>key <span style="color: #666666">&gt;</span> key:
                    tower<span style="color: #666666">.</span>push(current)
                    current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down
                <span style="color: #008000; font-weight: bold">else</span>:
                    current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>next

        lowest_level <span style="color: #666666">=</span> tower<span style="color: #666666">.</span>pop()
        temp <span style="color: #666666">=</span> DataNode(key, value)
        temp<span style="color: #666666">.</span>next <span style="color: #666666">=</span> lowest_level<span style="color: #666666">.</span>next
        lowest_level<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
        top <span style="color: #666666">=</span> temp
        <span style="color: #008000; font-weight: bold">while</span> randrange(<span style="color: #666666">2</span>) <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
            <span style="color: #008000; font-weight: bold">if</span> tower<span style="color: #666666">.</span>is_empty():
                newhead <span style="color: #666666">=</span> HeaderNode()
                temp <span style="color: #666666">=</span> DataNode(key, value)
                temp<span style="color: #666666">.</span>down <span style="color: #666666">=</span> top
                newhead<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
                newhead<span style="color: #666666">.</span>down <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
                <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> newhead
                top <span style="color: #666666">=</span> temp
            <span style="color: #008000; font-weight: bold">else</span>:
                next_level <span style="color: #666666">=</span> tower<span style="color: #666666">.</span>pop()
                temp <span style="color: #666666">=</span> DataNode(key, value)
                temp<span style="color: #666666">.</span>down <span style="color: #666666">=</span> top
                temp<span style="color: #666666">.</span>next <span style="color: #666666">=</span> next_level<span style="color: #666666">.</span>next
                next_level<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
                top <span style="color: #666666">=</span> temp
</code></pre></div></td></tr></table></div>
<p>我们还需要最后提到跳表的结构。我们之前提到，即使按相同的顺序插入，可能会有很多不同的跳表。现在我们明白了为什么。由于硬币抛掷的随机性质，任何特定键的塔的高度每次构建跳表时都会发生变化。</p>
</div>
<div class="tabbed-block">
<p>If we are given a skip list, the <code>search</code> method is fairly easy to implement. Our task here is to understand how the skip list structure was built in the first place and how it is possible that the same set of keys, added in the same order, can give us different skip lists.</p>
<p>Adding a new key-value pair to the skip list is essentially a two-step process. First, we search the skip list looking for the position where the key should have been. Remember that we are assuming the key is not already present. <code>Figure 9</code> shows this process as we look to add the key 65 (data value “hi”) to the collection. We have used the stars once again to show the path of the search process as it proceeds through the skip list.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/addskiplist.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/addskiplist.png" /></a>
    <figcaption markdown="span">Figure 9: Searching for the Key 65</figcaption>
</figure></p>
<p>As we proceed using the same search strategy as in the previous section, we find that 65 is greater than 31. Since there are no more nodes on level 3, we drop to level 2. Here we find 77, which is greater than 65. Again, we drop, this time to level 1. Now the next node is 54, which is less than 65. Continuing to the right, we hit 77, which again causes us to drop down until eventually we hit the <code>None</code> at the base of the tower.</p>
<p>The second step in the process is to create a new data node and add it to the level 0 linked list (<code>Figure 10</code>). However, if we stop at that point, the best we will ever have is a single linked list of key-value pairs. We also need to build a tower for the new entry, and this is where the skip list gets very interesting. How high should the tower be? The height of the tower for the new entry will not be predetermined but instead will be completely probabilistic. In essence, we will flip a coin to decide whether to add another level to the tower. Each time the coin comes up heads, we will add one more level to the current tower.</p>
<p><figure markdown="span">
    <a class="glightbox" href="../imgs/addskiplist2.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Image title" src="../imgs/addskiplist2.png" /></a>
    <figcaption markdown="span">Figure 10: Adding the Data Node and Tower for 65</figcaption>
</figure>   </p>
<p>It is easy to use a random number generator to simulate a coin flip. We can use <code>randrange</code> from the <code>random</code> module and interpret 1 as heads.</p>
<p><code>Listing lst_insert</code> shows the <code>insert</code> method. You will note immediately in line 2 that we need to check to see if this is the first node being added to the skip list. This is the same question we asked for simple linked lists. If we are adding to the head of the list, a new header node as well as data node must be created. The iteration in lines 7--14 continues as long as the <code>randrange</code> function returns a 1 (the coin toss returns heads). Each time a new level is added to the tower, a new data node and a new header node are created.</p>
<p>In the case of a non-empty skip list (line 15), we need to search for the insert position as described above. Since we have no way of knowing how many data nodes will be added to the tower, we need to save the insert points for every level that we enter as part of the search process. These insert points will be processed in reverse order, so a stack will work nicely to allow us to back up through the linked lists inserting tower data nodes as necessary. The stars in <code>Figure 10</code> show the insert points that would be stacked in the example. These points represent only those places where we dropped down during the search.</p>
<p>Starting at line 34, we flip our coin
to determine the number of levels for the tower. This time we pop the
insert stack to get the next higher insertion point as the tower grows.
Only after the stack becomes empty will we need to return to creating
new header nodes. We leave the remaining details of the implementation
for you to trace.</p>
<div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Listing lst_insert</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">30</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">31</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">32</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">33</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">34</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">35</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">36</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">37</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">38</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">39</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">40</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">41</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">42</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">43</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">44</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">45</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">46</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">47</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">48</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">49</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">insert</span>(<span style="color: #008000">self</span>, key, value):
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> HeaderNode()
        temp <span style="color: #666666">=</span> DataNode(key, value)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_head<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
        top <span style="color: #666666">=</span> temp
        <span style="color: #008000; font-weight: bold">while</span> randrange(<span style="color: #666666">2</span>) <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
            newhead <span style="color: #666666">=</span> HeaderNode()
            temp <span style="color: #666666">=</span> DataNode(key, value)
            temp<span style="color: #666666">.</span>down <span style="color: #666666">=</span> top
            newhead<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
            newhead<span style="color: #666666">.</span>down <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
            <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> newhead
            top <span style="color: #666666">=</span> temp
    <span style="color: #008000; font-weight: bold">else</span>:
        tower <span style="color: #666666">=</span> Stack()
        current <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
        <span style="color: #008000; font-weight: bold">while</span> current:
            <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
                tower<span style="color: #666666">.</span>push(current)
                current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down
            <span style="color: #008000; font-weight: bold">else</span>:
                <span style="color: #008000; font-weight: bold">if</span> current<span style="color: #666666">.</span>next<span style="color: #666666">.</span>key <span style="color: #666666">&gt;</span> key:
                    tower<span style="color: #666666">.</span>push(current)
                    current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>down
                <span style="color: #008000; font-weight: bold">else</span>:
                    current <span style="color: #666666">=</span> current<span style="color: #666666">.</span>next

        lowest_level <span style="color: #666666">=</span> tower<span style="color: #666666">.</span>pop()
        temp <span style="color: #666666">=</span> DataNode(key, value)
        temp<span style="color: #666666">.</span>next <span style="color: #666666">=</span> lowest_level<span style="color: #666666">.</span>next
        lowest_level<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
        top <span style="color: #666666">=</span> temp
        <span style="color: #008000; font-weight: bold">while</span> randrange(<span style="color: #666666">2</span>) <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
            <span style="color: #008000; font-weight: bold">if</span> tower<span style="color: #666666">.</span>is_empty():
                newhead <span style="color: #666666">=</span> HeaderNode()
                temp <span style="color: #666666">=</span> DataNode(key, value)
                temp<span style="color: #666666">.</span>down <span style="color: #666666">=</span> top
                newhead<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
                newhead<span style="color: #666666">.</span>down <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_head
                <span style="color: #008000">self</span><span style="color: #666666">.</span>_head <span style="color: #666666">=</span> newhead
                top <span style="color: #666666">=</span> temp
            <span style="color: #008000; font-weight: bold">else</span>:
                next_level <span style="color: #666666">=</span> tower<span style="color: #666666">.</span>pop()
                temp <span style="color: #666666">=</span> DataNode(key, value)
                temp<span style="color: #666666">.</span>down <span style="color: #666666">=</span> top
                temp<span style="color: #666666">.</span>next <span style="color: #666666">=</span> next_level<span style="color: #666666">.</span>next
                next_level<span style="color: #666666">.</span>next <span style="color: #666666">=</span> temp
                top <span style="color: #666666">=</span> temp
</code></pre></div></td></tr></table></div>
<p>We should make one final note about the structure of the skip list. We had mentioned earlier that there are many possible skip lists for a set of keys, even if they are inserted in the same order. Now we see why. Depending on the random nature of the coin flip, the height of the towers for any particular key is bound to change each time we build the skip list.</p>
</div>
</div>
</div>
<h3 id="8423-创建一个映射">8.4.2.3. 创建一个映射<a class="headerlink" href="#8423-创建一个映射" title="Permanent link">&para;</a></h3>
<p><strong>8.4.2.3. Building the Map</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>现在我们已经实现了跳表的行为，允许我们将数据添加到列表中并搜索现有数据，我们可以最终实现映射抽象数据类型。正如我们之前讨论的，映射必须提供两个操作，即 <code>put</code> 和 <code>get</code>。<code>Listing lst_mapclass</code> 显示了这些操作可以通过构造一个内部跳表集合（第 <code>[init:3]</code> 行）并使用前两节中展示的 <code>insert</code> 和 <code>search</code> 操作来轻松实现。</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_mapclass</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Map</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>collection <span style="color: #666666">=</span> SkipList()

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">put</span>(<span style="color: #008000">self</span>, key, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>collection<span style="color: #666666">.</span>insert(key, value)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get</span>(<span style="color: #008000">self</span>, key):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>collection<span style="color: #666666">.</span>search(key)
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Now that we have implemented the skip list behavior allowing us to add data to the list and search for data that is present, we are in a position to finally implement the map abstract data type. As we discussed above, maps must provide two operations, <code>put</code> and <code>get</code>. <code>Listing lst_mapclass</code> shows that these operations can easily be implemented by constructing an internal skip list collection (line <code>[init:3]</code>__) and using the <code>insert</code> and <code>search</code> operations shown in the previous two sections.</p>
<div class="language-python highlight" style="background: #f8f8f8"><span class="filename">Listing lst_mapclass</span><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Map</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>collection <span style="color: #666666">=</span> SkipList()

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">put</span>(<span style="color: #008000">self</span>, key, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>collection<span style="color: #666666">.</span>insert(key, value)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get</span>(<span style="color: #008000">self</span>, key):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>collection<span style="color: #666666">.</span>search(key)
</code></pre></div>
</div>
</div>
</div>
<h3 id="8424-分析1个跳表">8.4.2.4. 分析1个跳表<a class="headerlink" href="#8424-分析1个跳表" title="Permanent link">&para;</a></h3>
<p><strong>8.4.2.4. Analysis of a Skip List</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>如果我们仅仅将键值对存储在一个有序链表中，我们知道搜索方法的时间复杂度将是 <span class="arithmatex">\(O(n)\)</span>。我们能否期望跳表具有更好的性能？请记住，跳表是一种概率数据结构。这意味着分析将依赖于某个事件的概率，在这种情况下是掷硬币的结果。尽管对这种结构的严格分析超出了本文的范围，但我们可以做一个有力的非正式论证。</p>
<p>假设我们正在为 <span class="arithmatex">\(n\)</span> 个键构建一个跳表。我们知道每个塔的初始高度为 1。随着我们向塔中添加数据节点，假设获得正面的概率是 <span class="arithmatex">\(\frac{1}{2}\)</span>，我们可以说 <span class="arithmatex">\(\frac{n}{2}\)</span> 个键的塔的高度为 2。再掷一次硬币，<span class="arithmatex">\(\frac{n}{4}\)</span> 个键的塔的高度为 3。这对应于连续掷两次正面的概率。继续这个论证，我们可以看到 <span class="arithmatex">\(\frac{n}{8}\)</span> 个键的塔的高度为 4，以此类推。这意味着我们期望最高的塔的高度为 <span class="arithmatex">\(\log_{2}(n) + 1\)</span>。使用大 O 表示法，我们可以说跳表的高度为 <span class="arithmatex">\(O(\log (n))\)</span>。</p>
<p>为了分析 <code>search</code> 方法，请记住，在寻找给定键时需要考虑两个扫描方向。第一个是向下方向。之前的结果表明，在最坏的情况下，我们预计需要考虑 <span class="arithmatex">\(O(\log (n))\)</span> 层以找到一个键。此外，我们还需要包括在每一层上需要扫描的前向链接数量。当发生以下两种事件之一时，我们会降到下一层：要么我们找到一个键大于我们正在寻找的键的数据节点，要么我们到达某一层的末尾。如果我们当前正在查看某个数据节点，那么在下一个链接中发生这两种事件之一的概率是 <span class="arithmatex">\(\frac{1}{2}\)</span>。这意味着在查看两个链接之后，我们预计会降到下一层（我们预计在两个掷硬币之后得到正面）。无论如何，我们在任何给定层上需要查看的节点数量是常数。因此，总的结果是 <span class="arithmatex">\(O(\log (n))\)</span>。由于插入新节点的操作由寻找其位置主导，所以 <code>insert</code> 操作的性能也将是 <span class="arithmatex">\(O(\log(n))\)</span>。</p>
</div>
<div class="tabbed-block">
<p>If we had simply stored the key-value pairs in an ordered linked list, we know that the search method would be <span class="arithmatex">\(O(n)\)</span>. Can we expect better performance from the skip list? Recall that the skip list is a probabilistic data structure. This means that the analysis will be dependent upon the probability of some event, in this case, the flip of a coin. Although a rigorous analysis of this structure is beyond the scope of this text, we can make a strong informal argument.</p>
<p>Assume that we are building a skip list for <span class="arithmatex">\(n\)</span> keys. We know that each tower starts off with a height of 1. As we add data nodes to the tower, assuming the probability of getting heads is <span class="arithmatex">\(\frac{1}{2}\)</span>, we can say that <span class="arithmatex">\(\frac{n}{2}\)</span> of the keys have towers of height 2. As we flip the coin again, <span class="arithmatex">\(\frac{n}{4}\)</span> of the keys have a tower of height 3. This corresponds to the probability of flipping two heads in a row. Continuing this argument shows <span class="arithmatex">\(\frac{n}{8}\)</span> keys have a tower of height 4 and so on. This means that we expect the height of the tallest tower to be <span class="arithmatex">\(\log_{2}(n) + 1\)</span>. Using our Big-O notation, we would say that the height of the skip list is <span class="arithmatex">\(O(\log (n))\)</span>.</p>
<p>To analyze the <code>search</code> method, recall that there are two scans that need to be considered as we look for a given key. The first is the down direction. The previous result suggests that in the worst case we will expect to consider <span class="arithmatex">\(O(\log (n))\)</span> levels to find a key. In addition, we need to include the number of forward links that need to be scanned on each level. We drop down a level when one of two events occurs. Either we find a data node with a key that is greater than the key we are looking for or we find the end of a level. If we are currently looking at some data node, the probability that one of those two events will happen in the next link is <span class="arithmatex">\(\frac{1}{2}\)</span>. This means that after looking at two links, we would expect to drop to the next lower level (we expect to get heads after two coin flips). In any case, the number of nodes that we need to look at on any given level is constant. The entire result then becomes <span class="arithmatex">\(O(\log (n))\)</span>. Since inserting a new node is dominated by searching for its location, the <code>insert</code> operation will also have <span class="arithmatex">\(O(\log(n))\)</span> performance.</p>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月13日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年9月9日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>